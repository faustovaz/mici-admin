<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <title th:text="#{application.messages.title}">Mi & Ci</title>
        <link rel="stylesheet" th:href="@{/webjars/font-awesome/4.7.0/css/font-awesome.css}">
        <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css}">
        <link rel="stylesheet" th:href="@{/css/CalendarPicker.style.css}">
        <link rel="stylesheet" href='/css/main.css'>
    </head>
    <body>
	    <nav th:replace="fragments/top_menu :: top_menu"></nav>
	
	    <header id="main-header" class="py-4 mici-bgcolor text-black">
	        <div class="container">
	            <div class="row">
	                <div class="col-md-6">
	                    <h4><i class="fa fa-address-book"></i> Atendimentos</h4>
	                </div>
	            </div>
	        </div>
	    </header>
	
		<section class="mt-2">
	  		<div class="container">
				<form th:action="@{/atendimentos/atualizar}" method="post">
	      			<div class="card">
	        			<div class="card-header">
	          				<h5 th:text="|Cliente: ${atendimento.cliente.nome}|"></h5>
	          				<input type="hidden" id="idCliente" name="idCliente" th:value=${atendimento.cliente.id}>
	          				<input type="hidden" id="idAtendimento" name="idAtendimento" th:value=${atendimento.id}>
	        			</div>
		        		<div class="card-body">
		          			<ul class="list-group list-group-flush">
		            			<li class="list-group-item">
			                    	<table class="table table-striped table-hover align-middle table-borderless">
                        				<thead>
                            				<tr>
                                				<th>Serviço</th>
                            					<th>Preço</th>
                            				</tr>
                        				</thead>
                        				<tbody>
                            				<tr th:each="itemAtendimento : ${atendimento.itensAtendimento}">
                                				<td th:text="${itemAtendimento.servico.nome}"></td>
                                				<td th:text="${#numbers.formatCurrency(itemAtendimento.precoAplicado)}"></td>
				                            </tr>
                				        </tbody>
                    				</table>
	            				</li>
		            			<li class="list-group-item">
		              				<div class="row">
		                				<div class="col  d-flex justify-content-end my-3">
		                  					<h5>Total do atendimento: <span class="badge bg-secondary" id="total-atendimento" th:text=${#numbers.formatCurrency(atendimento.totalAtendimento)}>R$ 0.00</span></h5>
		                				</div>
		              				</div>
		              				<div class="row">
		                				<div class="col d-flex justify-content-end">
		                  					<div class="mb-3">
		                  						<span class="me-3">Data do Atendimento</span>
												<input type="date" disabled class="form-control" name="dataAtendimento" id="dataAtendimento" th:value="${atendimento.diaDoAtendimento}">
		                  					</div>
		                				</div>
		              				</div>
		              				<div class="row">
		                				<div class="col d-flex justify-content-end">
		                  					<div class="mb-3">
		                  						<span class="me-3">É uma cortesia?</span>
		                  						<input type="radio" id="cortesia_sim" name="cortesia" value="true" th:checked="${atendimento.cortesia}"> Sim
		                    					<input class="ms-2" type="radio" id="cortesia_nao" name="cortesia" value="false" th:checked="${ not atendimento.cortesia}"> Não
		                  					</div>
		                				</div>
		              				</div>
		              				<section id="dados-pagamento">
			              				<div class="row">
			                				<div class="col d-flex justify-content-end">
			                  					<div class="mb-3">
			                    					<input type="checkbox" name="pagamentoRealizado" id="pagamentoRealizado" th:checked="${atendimento.pagamentoRealizado}"> Pagamento realizado
			                  					</div>
			                				</div>
			              				</div>
	    								<div class="row">
	  										<div class="col d-flex justify-content-end">
												<div class="mb-3">
	  												<label for="nome" class="form-label">Forma de Pagamento</label>
	  												<select class="form-select" name="formaPgto" id="formaPgto" aria-label="Default select example">
	  													<option selected value="0">Selecione</option>
														<option th:each="formaPagamento: ${formasPagamento}" 
															th:value="${formaPagamento.id}" 
															th:selected="${atendimento.formaPagamento != null && atendimento.formaPagamento.id == formaPagamento.id}"
															th:text="${formaPagamento.nome}">
	  												</select>
												</div>
	  										</div>
	  									</div>
		              				</section>
									<div class="row">
                    					<div class="col d-flex justify-content-end">
	                      					<div class="mb-3">
	                        					<label for="nome" class="form-label">Observação</label>
	                    						<textarea 
	                    							name="atendimentoObservacao" 
	                    							id="atendimentoObservacao" 
	                    							cols="30" 
	                    							rows="3" 
	                    							class="form-control"
	                    							th:text="${atendimento.observacao}"></textarea>
	                      					</div>
                    					</div>
                					</div>
		            			</li>
		          			</ul>
		        		</div>
		        		<div class="card-footer d-flex justify-content-center">
		          			<input type="submit" class="btn btn-primary me-3" value="Salvar">
		      				<a th:href="@{'/atendimentos/listar/' + ${atendimento.cliente.id}}"  class="btn btn-outline-secondary me-3">Cancelar</a>
           	             	<a th:href="@{'/atendimentos/remover/' + ${atendimento.id}}" class="btn btn-danger" onclick="return confirm('Tem certeza que deseja remover?')">
                            	<i class="fa fa-trash"></i>
                           </a>     
		        		</div>
	      			</div>
				</form>
	  		</div>
		</section>
	
		
		<script th:src="@{/webjars/bootstrap/js/bootstrap.bundle.min.js}"></script>
	</body>
</html>
